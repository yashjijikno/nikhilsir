import tkinter as tk
from tkinter import ttk

# Mapping for average months
average_months_data = {
    "Monthly": {
        "Beginning of each month": 13 / 2,
        "End of each month": 11 / 2,
        "Mid of each month": 12 / 2
    },
    "Quarterly": {
        "Beginning of each quarter": 15 / 2,
        "End of each quarter": 9.5,  # 19/2
        "Mid of each quarter": 12 / 2
    },
    "Half-Yearly": {
        "Beginning of half year": 18 / 2,
        "Mid of half year": 12 / 2,
        "End of half year": 6 / 2
    }
}

# Function to update dropdown options
def update_second_dropdown(event=None):
    selected_period = period_type_var.get()
    avg_options = list(average_months_data[selected_period].keys())
    avg_option_var.set(avg_options[0])
    avg_dropdown['menu'].delete(0, 'end')
    for option in avg_options:
        avg_dropdown['menu'].add_command(label=option, command=tk._setit(avg_option_var, option))

# Function to calculate interest
def calculate_interest():
    try:
        amount = float(amount_entry.get())
        no_of_months = int(months_entry.get())
        rate = float(rate_entry.get())
        avg_month = average_months_data[period_type_var.get()][avg_option_var.get()]
        
        interest = (amount * no_of_months * rate / 100 * avg_month * 1/12)
        result_label.config(
            text=f"üí∞ Your Interest on Drawing is: {interest:.2f}",
            fg="#00ff88"
        )
    except ValueError:
        result_label.config(text="‚ùå Please enter valid numbers!", fg="red")

# Main window
root = tk.Tk()
root.title("IOD Calculator - COMION")
root.geometry("450x500")
root.configure(bg="#1e1e2f")  # Dark theme

# Header
header_frame = tk.Frame(root, bg="#ff6f61")
header_frame.pack(fill="x")
tk.Label(
    header_frame,
    text="IOD CALCULATOR",
    font=("Segoe UI", 20, "bold"),
    fg="white",
    bg="#ff6f61",
    pady=10
).pack()
tk.Label(
    header_frame,
    text="BY COMION",
    font=("Segoe UI", 12, "bold"),
    fg="#ffe066",
    bg="#ff6f61",
    pady=2
).pack()

# Styling for ttk
style = ttk.Style()
style.configure("TButton", font=("Segoe UI", 10, "bold"), padding=6, background="#00cc99")
style.configure("TMenubutton", font=("Segoe UI", 10), padding=4)

# Container frame
main_frame = tk.Frame(root, bg="#1e1e2f")
main_frame.pack(pady=15)

# Period Type
tk.Label(main_frame, text="Select Period Type:", font=("Segoe UI", 10, "bold"), fg="white", bg="#1e1e2f").pack(pady=3)
period_type_var = tk.StringVar(value="Monthly")
period_dropdown = ttk.OptionMenu(main_frame, period_type_var, "Monthly", *average_months_data.keys(), command=update_second_dropdown)
period_dropdown.pack(pady=3)

# Average Month Option
tk.Label(main_frame, text="Select Average Month Option:", font=("Segoe UI", 10, "bold"), fg="white", bg="#1e1e2f").pack(pady=3)
avg_option_var = tk.StringVar()
avg_dropdown = ttk.OptionMenu(main_frame, avg_option_var, "")
avg_dropdown.pack(pady=3)
update_second_dropdown()

# Amount Entry
tk.Label(main_frame, text="Enter Drawing Amount:", font=("Segoe UI", 10, "bold"), fg="white", bg="#1e1e2f").pack(pady=3)
amount_entry = tk.Entry(main_frame, font=("Segoe UI", 10), bg="#333344", fg="white", relief="flat", justify="center")
amount_entry.pack(pady=3, ipady=4)

# Months Entry
tk.Label(main_frame, text="Enter Number of Months:", font=("Segoe UI", 10, "bold"), fg="white", bg="#1e1e2f").pack(pady=3)
months_entry = tk.Entry(main_frame, font=("Segoe UI", 10), bg="#333344", fg="white", relief="flat", justify="center")
months_entry.pack(pady=3, ipady=4)

# Rate Entry
tk.Label(main_frame, text="Enter Rate of Interest (%):", font=("Segoe UI", 10, "bold"), fg="white", bg="#1e1e2f").pack(pady=3)
rate_entry = tk.Entry(main_frame, font=("Segoe UI", 10), bg="#333344", fg="white", relief="flat", justify="center")
rate_entry.pack(pady=3, ipady=4)

# Calculate Button
calc_btn = tk.Button(root, text="CALCULATE", font=("Segoe UI", 12, "bold"), bg="#00cc99", fg="black", relief="flat", command=calculate_interest)
calc_btn.pack(pady=15, ipadx=20, ipady=5)

# Result Label
result_label = tk.Label(root, text="", font=("Segoe UI", 12, "bold"), bg="#1e1e2f")
result_label.pack(pady=10)

root.mainloop()
(isko html css or java script me convert kar de badiya se stylish mordan finencial look type )
